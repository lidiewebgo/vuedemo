{"remainingRequest":"/Users/isaac-chip/Desktop/vue-admin-template/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/isaac-chip/Desktop/vue-admin-template/src/components/Tags/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/isaac-chip/Desktop/vue-admin-template/src/components/Tags/index.vue","mtime":1598887868707},{"path":"/Users/isaac-chip/Desktop/vue-admin-template/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/isaac-chip/Desktop/vue-admin-template/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/isaac-chip/Desktop/vue-admin-template/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/isaac-chip/Desktop/vue-admin-template/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAidnVleCI7CmltcG9ydCBlbGVtZW50UmVzaXplRGV0ZWN0b3JNYWtlciBmcm9tICJlbGVtZW50LXJlc2l6ZS1kZXRlY3RvciI7CmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY29udGV4dE1lbnVWaXNpYmxlOiBmYWxzZSwgLy8g5piv5ZCm5pi+56S66I+c5Y2VCiAgICAgIG1lbnVMZWZ0OiAiIiwgLy8g5Y+z6ZSu6I+c5Y2V6Led56a75rWP6KeI5Zmo5bem6L6555qE6Led56a7CiAgICAgIG1lbnVUb3A6ICIiLCAvLyDlj7PplK7oj5zljZXot53nprvmtY/op4jlmajkuIrovrnnmoTot53nprsKICAgICAgdGFnSW5kZXg6IDAsIC8vIOW9k+WJjeeCueWHu+eahHRhZ+eahOe0ouW8lQogICAgICB0YWc6IHt9LCAvLyDlvZPliY3lj7PplK7ngrnlh7vnmoR0YWflr7nosaEKICAgICAgYXJyb3dWaXNpYmxlOiBmYWxzZSwgLy8g5piv5ZCm5pi+56S6566t5aS0CiAgICAgIHRhZ3NCb3hXaWR0aDogMCwgLy8gcmVmIOS4uiBvdXRCb3gg55qE6ZW/5bqmCiAgICAgIHRhZ3NXaWR0aDogMCwgLy8gcmVmIOS4uiB0YWdzIOeahOmVv+W6pgogICAgICBsZWZ0OiAwLCAvLyByZWYg5Li6IGJveCDoioLngrnnm7jlr7nkuo7lt6bovrnnmoTot53nprvvvIznlKjkuo7nrq3lpLTngrnlh7sKICAgIH07CiAgfSwKICBtb3VudGVkKCkgewogICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKGUpID0+IHsKICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7CiAgICAgIGlmICh0YXJnZXQubm9kZU5hbWUgIT09ICJTUEFOIikgewogICAgICAgIC8vIOWPquimgeeCueWHu+eahOS4jeaYr2VsLXRhZ+WwseWPr+S7peWFs+mXre+8jOWboOS4umVsLXRhZ+aYr+eUqHNwYW7moIfnrb7lrp7njrDnmoQKICAgICAgICB0aGlzLmNvbnRleHRNZW51VmlzaWJsZSA9IGZhbHNlOwogICAgICB9CiAgICB9KTsKCiAgICB0aGlzLmxlbiA9IHRoaXMudGFncy5sZW5ndGg7CiAgICB0aGlzLnRhZ3NXaWR0aCA9IHRoaXMuJHJlZnMudGFncy5vZmZzZXRXaWR0aDsKICAgIGNvbnN0IGVyZCA9IGVsZW1lbnRSZXNpemVEZXRlY3Rvck1ha2VyKCk7CiAgICBlcmQubGlzdGVuVG8odGhpcy4kcmVmcy5vdXRCb3gsIChlbGUpID0+IHsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMudGFnc0JveFdpZHRoID0gZWxlLm9mZnNldFdpZHRoOwogICAgICAgIGlmICh0aGlzLnRhZ3NCb3hXaWR0aCA+PSB0aGlzLnRhZ3NXaWR0aCkgewogICAgICAgICAgdGhpcy5hcnJvd1Zpc2libGUgPSB0cnVlOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmFycm93VmlzaWJsZSA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9KTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSh7CiAgICAgIHRhZ3M6IChzdGF0ZSkgPT4gc3RhdGUudGFncy50YWdMaXN0LAogICAgfSksCiAgfSwKCiAgbWV0aG9kczogewogICAgcmVmcmVzaCgpIHsKICAgICAgdGhpcy4kcm91dGVyLmdvKDApOwogICAgfSwKICAgIGhhbmRsZUNsaWNrQ29udGV4dE1lbnUoZXZlbnQpIHsKICAgICAgY29uc3QgZSA9IGV2ZW50IHx8IHdpbmRvdy5ldmVudDsKICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7CiAgICAgIHRoaXMubWVudUxlZnQgPSBlLmxheWVyWCArIDIwICsgInB4IjsgLy8g6I+c5Y2V5Ye6546w55qE5L2N572u6Led56a75bem5L6n55qE6Led56a7CiAgICAgIHRoaXMubWVudVRvcCA9IGUubGF5ZXJZICsgMjAgKyAicHgiOyAvLyDoj5zljZXlh7rnjrDnmoTkvY3nva7ot53nprvpobbpg6jnmoTot53nprsKICAgICAgdGhpcy50YWdJbmRleCA9IE51bWJlcih0YXJnZXQuZ2V0QXR0cmlidXRlKCJkYXRhLWluZGV4IikpOyAvLyDojrflj5blvZPliY3lj7Plh7voj5zljZXnmoTntKLlvJXjgILku44w5byA5aeLCiAgICAgIHRoaXMuY29udGV4dE1lbnVWaXNpYmxlID0gdHJ1ZTsgLy8g5pi+56S66I+c5Y2VCiAgICAgIHRoaXMudGFnID0gdGhpcy50YWdzW3RoaXMudGFnSW5kZXhdOyAvLyDlvZPliY3lj7Plh7vnmoToj5zljZXkv6Hmga8KICAgIH0sCiAgICAvKioKICAgICAqIOWPguaVsOivtOaYjgogICAgICogdGFnIOW9k+WJjeWPs+WHu+eahOagh+etvuaJgOWtmOeahOWvueixoQogICAgICogaW5kZXgg5b2T5YmN5Y+z5Ye75qCH562+55qE57Si5byVCiAgICAgKiBkZWxDb3VudCDliKDpmaTkuKrmlbDvvIzpu5jorqTliKDpmaQx5LiqCiAgICAgKiBpc0Nsb3NlT3RoZXIg5piv5ZCm5Yig6Zmk5YW25LuWIOm7mOiupOS4jeaYrwogICAgICovCiAgICBoYW5kbGVUYWdDbG9zZSh0YWcsIGluZGV4LCBkZWxDb3VudCA9IDEsIGlzQ2xvc2VPdGhlciA9IGZhbHNlKSB7CiAgICAgIGNvbnN0IGxlbmd0aCA9IHRoaXMudGFncy5sZW5ndGggLSAxOwogICAgICBjb25zdCBwYXlsb2FkID0gewogICAgICAgIGluZGV4LAogICAgICAgIGRlbENvdW50LAogICAgICAgIGlzQ2xvc2VPdGhlciwKICAgICAgfTsKCiAgICAgIC8vIOaJp+ihjOWtmOagh+etvgogICAgICB0aGlzLiRzdG9yZS5kaXNwYXRjaCgidGFncy9jbG9zZVRhZyIsIHBheWxvYWQpOwoKICAgICAgLy8g54K55Ye75YWz6Zet5YW25LuW77yM5bm25LiU5LiN5piv5b2T5YmN5omA5Zyo55qE6aG16Z2iCiAgICAgIGlmICh0YWcubmFtZSAhPT0gdGhpcy4kcm91dGUubmFtZSAmJiBpc0Nsb3NlT3RoZXIpIHsKICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6IHRhZy5uYW1lIH0pOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgLy8g5Y+z5Ye755qE5qCH562+5q2j5piv5b2T5YmN5omT5byA55qE6aG16Z2i5bm25LiU5LiN5piv5pyA5ZCO5LiA5LiqCiAgICAgIGlmICh0YWcubmFtZSA9PT0gdGhpcy4kcm91dGUubmFtZSAmJiBpbmRleCA8IHRoaXMudGFncy5sZW5ndGggLSAxKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goeyBuYW1lOiB0aGlzLnRhZ3NbaW5kZXggKyAxXS5uYW1lIH0pOwogICAgICB9CgogICAgICAvLyDlhbPpl63nmoTmoIfnrb7mmK/mnIDlj7PovrnnmoTor53vvIzlvoDlt6bovrnot7PovazkuIDkuKoKICAgICAgaWYgKGluZGV4ID09PSBsZW5ndGggJiYgIWlzQ2xvc2VPdGhlcikgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogdGhpcy50YWdzW2luZGV4IC0gMV0ubmFtZSB9KTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKGluZGV4IDw9IGxlbmd0aCAmJiAhaXNDbG9zZU90aGVyKSB7CiAgICAgICAgLy8g5ZCm5YiZ5b6A5Y+z6L656Lez6L2sCiAgICAgICAgaWYgKGluZGV4ICE9PSAxKSB0aGlzLiRyb3V0ZXIucHVzaCh7IG5hbWU6IHRoaXMudGFnc1tpbmRleF0ubmFtZSB9KTsKICAgICAgfQogICAgfSwKICAgIGNsb3NlVGFnKCkgewogICAgICBpZiAodGhpcy50YWdzLmxlbmd0aCA9PT0gMSkgcmV0dXJuOwogICAgICB0aGlzLmhhbmRsZVRhZ0Nsb3NlKHRoaXMudGFnLCB0aGlzLnRhZ0luZGV4KTsKICAgIH0sCiAgICBjbG9zZU90aGVyVGFnKCkgewogICAgICBpZiAodGhpcy50YWdzLmxlbmd0aCA9PT0gMikgcmV0dXJuOwogICAgICBpZiAodGhpcy50YWdJbmRleCA9PT0gMSkgewogICAgICAgIHRoaXMuaGFuZGxlVGFnQ2xvc2UoCiAgICAgICAgICB0aGlzLnRhZywKICAgICAgICAgIHRoaXMudGFnSW5kZXggKyAxLAogICAgICAgICAgdGhpcy50YWdzLmxlbmd0aCwKICAgICAgICAgIHRydWUKICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdGhpcy5oYW5kbGVUYWdDbG9zZSh0aGlzLnRhZywgMSwgdGhpcy50YWdJbmRleCAtIDEsIHRydWUpOwogICAgICB0aGlzLmhhbmRsZVRhZ0Nsb3NlKHRoaXMudGFnLCB0aGlzLnRhZ0luZGV4LCB0aGlzLnRhZ3MubGVuZ3RoLCB0cnVlKTsKICAgIH0sCiAgICBjbG9zZUFsbFRhZygpIHsKICAgICAgaWYgKHRoaXMudGFncy5sZW5ndGggPT09IDEpIHJldHVybjsKICAgICAgdGhpcy5oYW5kbGVUYWdDbG9zZSh0aGlzLnRhZywgMSwgdGhpcy50YWdzLmxlbmd0aCk7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsgbmFtZTogImhvbWUiIH0pOwogICAgfSwKICAgIGhhbmRsZUNsaWNrVG9MZWZ0KCkgewogICAgICB0aGlzLmxlZnQgPSAwOwogICAgfSwKICAgIGhhbmRsZUNsaWNrVG9MZWZ0KCkgewogICAgICB0aGlzLmxlZnQgPSB0aGlzLnRhZ3NXaWR0aCAtIHRoaXMudGFnc0JveFdpZHRoIC0gMzA7CiAgICB9LAogICAgaGFuZGxlVGFnQ2xpY2soZSwgdGFnKSB7CiAgICAgIGNvbnNvbGUuZ3JvdXAoIi0tLSIpOwogICAgICBjb25zb2xlLmxvZyhlKTsKICAgICAgY29uc29sZS5sb2codGFnLnBhdGgpOwogICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7IHBhdGg6IGAke3RhZy5wYXRofWAgfSk7CiAgICB9LAogICAgaGFuZGxlQ2xpY2tUb0xlZnQoKSB7CiAgICAgIHRoaXMubGVmdCA9IDA7CiAgICB9LAogICAgaGFuZGxlQ2xpY2tUb0xlZnQgKCkgewogIHRoaXMubGVmdCA9IHRoaXMudGFnc1dpZHRoIC0gdGhpcy50YWdzQm94V2lkdGggLSAzMAp9CgogIH0sCn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"index.vue","sourceRoot":"src/components/Tags","sourcesContent":["<template>\n  <div\n    class=\"tags\"\n    @contextmenu.prevent\n    ref=\"tags\"\n    :style=\"{'padding': arrowVisible ? '12px 0' : '12px 10px'}\"\n  >\n    <div class=\"tags-out-box\" ref=\"outBox\">\n      <div class=\"svg arrow\" v-if=\"arrowVisible\" @click=\"handleClickToLeft\">\n        <svg-icon icon-class=\"arrow-left\" />\n      </div>\n      <div\n        class=\"tags-box\"\n        ref=\"box\"\n        :style=\"{'padding-left': arrowVisible ? '30px' : '0', left: `${left}px`}\"\n      >\n        <el-tag\n          style=\"width:600px\"\n          ref=\"tag\"\n          size=\"small\"\n          v-for=\"(tag, i) in tags\"\n          :data-index=\"i\"\n          :data-id=\"tag.menuId\"\n          :key=\"tag.name\"\n          :closable=\"tag.name !== 'home'\"\n          :effect=\"$route.name === tag.name ? 'dark' : 'plain'\"\n          @contextmenu.native.prevent=\"handleClickContextMenu($event)\"\n          @click=\"handleTagClick($event, tag)\"\n          @close=\"handleTagClose(tag, i)\"\n        >{{tag.label}}</el-tag>\n      </div>\n      <div class=\"svg arrow arrow-right\" v-if=\"arrowVisible\" @click=\"handleClickToRight\">\n        <svg-icon icon-class=\"arrow-right\" />\n      </div>\n    </div>\n\n    <ul class=\"right-menu\" :style=\"{left: menuLeft, top: menuTop}\" v-show=\"contextMenuVisible\">\n      <a href=\"javascript:;\" @click=\"refresh\">刷新</a>\n      <a href=\"javascript:;\" @click=\"closeTag\" v-if=\"tagIndex !== 0\">关闭</a>\n      <a href=\"javascript:;\" @click=\"closeOtherTag\" v-if=\"tagIndex !== 0\">关闭其它</a>\n      <a href=\"javascript:;\" @click=\"closeAllTag\">关闭所有</a>\n    </ul>\n  </div>\n</template>\n\n<script>\nimport { mapState } from \"vuex\";\nimport elementResizeDetectorMaker from \"element-resize-detector\";\nexport default {\n  data() {\n    return {\n      contextMenuVisible: false, // 是否显示菜单\n      menuLeft: \"\", // 右键菜单距离浏览器左边的距离\n      menuTop: \"\", // 右键菜单距离浏览器上边的距离\n      tagIndex: 0, // 当前点击的tag的索引\n      tag: {}, // 当前右键点击的tag对象\n      arrowVisible: false, // 是否显示箭头\n      tagsBoxWidth: 0, // ref 为 outBox 的长度\n      tagsWidth: 0, // ref 为 tags 的长度\n      left: 0, // ref 为 box 节点相对于左边的距离，用于箭头点击\n    };\n  },\n  mounted() {\n    window.addEventListener(\"click\", (e) => {\n      const target = e.target;\n      if (target.nodeName !== \"SPAN\") {\n        // 只要点击的不是el-tag就可以关闭，因为el-tag是用span标签实现的\n        this.contextMenuVisible = false;\n      }\n    });\n\n    this.len = this.tags.length;\n    this.tagsWidth = this.$refs.tags.offsetWidth;\n    const erd = elementResizeDetectorMaker();\n    erd.listenTo(this.$refs.outBox, (ele) => {\n      this.$nextTick(() => {\n        this.tagsBoxWidth = ele.offsetWidth;\n        if (this.tagsBoxWidth >= this.tagsWidth) {\n          this.arrowVisible = true;\n        } else {\n          this.arrowVisible = false;\n        }\n      });\n    });\n  },\n  computed: {\n    ...mapState({\n      tags: (state) => state.tags.tagList,\n    }),\n  },\n\n  methods: {\n    refresh() {\n      this.$router.go(0);\n    },\n    handleClickContextMenu(event) {\n      const e = event || window.event;\n      const target = e.target;\n      this.menuLeft = e.layerX + 20 + \"px\"; // 菜单出现的位置距离左侧的距离\n      this.menuTop = e.layerY + 20 + \"px\"; // 菜单出现的位置距离顶部的距离\n      this.tagIndex = Number(target.getAttribute(\"data-index\")); // 获取当前右击菜单的索引。从0开始\n      this.contextMenuVisible = true; // 显示菜单\n      this.tag = this.tags[this.tagIndex]; // 当前右击的菜单信息\n    },\n    /**\n     * 参数说明\n     * tag 当前右击的标签所存的对象\n     * index 当前右击标签的索引\n     * delCount 删除个数，默认删除1个\n     * isCloseOther 是否删除其他 默认不是\n     */\n    handleTagClose(tag, index, delCount = 1, isCloseOther = false) {\n      const length = this.tags.length - 1;\n      const payload = {\n        index,\n        delCount,\n        isCloseOther,\n      };\n\n      // 执行存标签\n      this.$store.dispatch(\"tags/closeTag\", payload);\n\n      // 点击关闭其他，并且不是当前所在的页面\n      if (tag.name !== this.$route.name && isCloseOther) {\n        this.$router.push({ name: tag.name });\n        return;\n      }\n\n      // 右击的标签正是当前打开的页面并且不是最后一个\n      if (tag.name === this.$route.name && index < this.tags.length - 1) {\n        this.$router.push({ name: this.tags[index + 1].name });\n      }\n\n      // 关闭的标签是最右边的话，往左边跳转一个\n      if (index === length && !isCloseOther) {\n        this.$router.push({ name: this.tags[index - 1].name });\n        return;\n      }\n      if (index <= length && !isCloseOther) {\n        // 否则往右边跳转\n        if (index !== 1) this.$router.push({ name: this.tags[index].name });\n      }\n    },\n    closeTag() {\n      if (this.tags.length === 1) return;\n      this.handleTagClose(this.tag, this.tagIndex);\n    },\n    closeOtherTag() {\n      if (this.tags.length === 2) return;\n      if (this.tagIndex === 1) {\n        this.handleTagClose(\n          this.tag,\n          this.tagIndex + 1,\n          this.tags.length,\n          true\n        );\n        return;\n      }\n\n      this.handleTagClose(this.tag, 1, this.tagIndex - 1, true);\n      this.handleTagClose(this.tag, this.tagIndex, this.tags.length, true);\n    },\n    closeAllTag() {\n      if (this.tags.length === 1) return;\n      this.handleTagClose(this.tag, 1, this.tags.length);\n      this.$router.push({ name: \"home\" });\n    },\n    handleClickToLeft() {\n      this.left = 0;\n    },\n    handleClickToLeft() {\n      this.left = this.tagsWidth - this.tagsBoxWidth - 30;\n    },\n    handleTagClick(e, tag) {\n      console.group(\"---\");\n      console.log(e);\n      console.log(tag.path);\n      this.$router.push({ path: `${tag.path}` });\n    },\n    handleClickToLeft() {\n      this.left = 0;\n    },\n    handleClickToLeft () {\n  this.left = this.tagsWidth - this.tagsBoxWidth - 30\n}\n\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n// tag组件样式\n.tags {\n  width: 100%;\n  white-space: nowrap;\n  background-color: blue;\n  padding: 12px 10px;\n  &-out-box {\n    display: inline-block;\n    position: relative;\n  }\n  &-box {\n    position: relative;\n    transition: 0.3s;\n  }\n}\n</style>"]}]}